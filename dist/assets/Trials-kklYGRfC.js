import{f as K,R as r,j as e,L as Y}from"./index-D6Ufhlin.js";import{S as B}from"./SiteHeader-DVJcy74P.js";import{f as D,a as P,b as F}from"./ctgov-D30T4kGK.js";import{g as U,i as G,a as J}from"./providerTrials-D3cdPr4h.js";import{b as O,a as V}from"./searchQuery-DiK0pgnx.js";import{S as W}from"./search-CHzgFv4o.js";import{L as X}from"./loader-circle-DSMSzSe0.js";import{P as Z}from"./plus-DQgQ9eCg.js";import{P as _,T as ee}from"./trash-2-Dy6-2vg2.js";import"./HeaderActions-BQWpB5F1.js";function me(){const{user:c}=K(),l=(c==null?void 0:c.userId)||"",[o,L]=r.useState(""),[m,y]=r.useState(!1),[x,u]=r.useState(""),[g,q]=r.useState([]),[M,$]=r.useState(()=>{const t={};return l&&U(l).forEach(s=>{s.nctId&&(t[s.nctId]=!0)}),t}),[i,h]=r.useState([]),R=r.useCallback(async()=>{const t=o.trim();if(t){y(!0),u("");try{const s=/^NCT\d{8}$/i.test(t);let a=s?await D(t):await P({q:O(t),pageSize:12});if(!s&&(a.studies||[]).length===0){const d=V(t);a=await P({q:d||t,pageSize:12})}q(a.studies||[]),(a.studies||[]).length===0&&u("No studies found.")}catch{u("Failed to load studies. Please try again.")}finally{y(!1)}}},[o]),Q=t=>{t.preventDefault(),R()};return e.jsxs("div",{className:"min-h-screen bg-gray-50 text-gray-900",children:[e.jsx(B,{}),e.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-10",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-semibold text-center",children:"Active Clinical Trials"}),e.jsx("p",{className:"mt-2 text-center text-gray-600",children:"Link your ongoing trials to TrialCliniq for faster patient match opportunities. You can search existing trials from ClinicalTrials.gov or add them manually."}),e.jsxs("section",{className:"mt-8 space-y-5",children:[e.jsx("div",{className:"rounded-2xl border bg-white p-5",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Register a Clinical Trial"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"If your trial isn’t available via search, you can manually register it here to connect with eligible participants."})]}),e.jsxs(Y,{to:"#",className:"inline-flex items-center gap-2 rounded-full border px-4 py-2 text-sm hover:bg-gray-50","aria-label":"Add Trial Manually",children:["Add Trial Manually ",e.jsx("span",{"aria-hidden":!0,children:"→"})]})]})}),e.jsxs("div",{className:"rounded-2xl border bg-white p-5",children:[e.jsx("div",{className:"text-sm text-gray-700",children:"Search from ClinicalTrials.gov"}),e.jsx("form",{onSubmit:Q,className:"mt-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"}),e.jsx("input",{value:o,onChange:t=>L(t.target.value),className:"w-full rounded-full border px-10 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter Trial NCT Number or Keyword","aria-label":"Enter Trial NCT Number or Keyword"}),e.jsx("button",{type:"submit",className:"absolute right-1 top-1/2 -translate-y-1/2 rounded-full bg-gray-900 px-4 py-2 text-white text-sm hover:bg-black",children:"Search"})]})}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500 flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-emerald-500","aria-hidden":!0}),"Your data stays private and protected with HIPAA-compliant security."]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[m&&e.jsxs("div",{className:"p-4 text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 animate-spin"})," Loading…"]}),!m&&x&&e.jsx("div",{className:"p-4 text-sm border border-red-200 bg-red-50 text-red-700 rounded",children:x}),!m&&!x&&g.length>0&&e.jsx("ul",{className:"rounded-xl border overflow-hidden",children:g.map((t,s)=>{var v,w,S,T,C,I,A,k,E;const a=((w=(v=t.protocolSection)==null?void 0:v.identificationModule)==null?void 0:w.nctId)||"",d=((T=(S=t.protocolSection)==null?void 0:S.identificationModule)==null?void 0:T.briefTitle)||"Untitled",p=((I=(C=t.protocolSection)==null?void 0:C.statusModule)==null?void 0:I.overallStatus)||"",b=((E=(k=(A=t.protocolSection)==null?void 0:A.sponsorCollaboratorsModule)==null?void 0:k.leadSponsor)==null?void 0:E.name)||"",j=F(t),z=`${a||"idx"}-${s}`,N=!!(a&&i.some(n=>n.nctId===a)),f=a&&l?M[a]||G(l,a):!1;return e.jsxs("li",{className:"flex items-center justify-between px-4 py-3 border-t first:border-t-0 bg-white hover:bg-gray-50",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-900 truncate",children:d}),e.jsxs("div",{className:"text-[11px] text-gray-500 truncate",children:[a,p?` · ${p}`:"",j?` · ${j}`:"",b?` · ${b}`:""]})]}),e.jsxs("div",{className:"shrink-0 flex items-center gap-2",children:[!f&&!N&&e.jsxs("button",{type:"button",onClick:()=>{a&&h(n=>n.some(H=>H.nctId===a)?n:[...n,{nctId:a,title:d,status:p}])},className:"inline-flex items-center gap-1 rounded-full border px-3 py-1 text-xs hover:bg-gray-50",children:[e.jsx(Z,{className:"w-3.5 h-3.5"})," Add"]}),(f||N)&&e.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 text-emerald-700 px-3 py-1 text-xs",children:f?"Added":"Selected"})]})]},z)})})]}),i.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"rounded-2xl border overflow-hidden bg-white",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-left text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium",children:"Trial Title"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"NCT Number"}),e.jsx("th",{className:"px-4 py-3 font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-medium text-right",children:"Actions"})]})}),e.jsx("tbody",{children:i.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:t.title}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:t.nctId}),e.jsx("td",{className:"px-4 py-3",children:t.status||"-"}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border px-3 py-1 text-xs hover:bg-gray-50 mr-2",disabled:!0,title:"Edit (coming soon)",children:[e.jsx(_,{className:"w-3.5 h-3.5"})," Edit"]}),e.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full border px-3 py-1 text-xs hover:bg-gray-50",onClick:()=>h(s=>s.filter(a=>a.nctId!==t.nctId)),children:[e.jsx(ee,{className:"w-3.5 h-3.5"})," Remove"]})]})]},t.nctId))})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"button",onClick:()=>{if(l){i.forEach(s=>J(l,{nctId:s.nctId,title:s.title,status:s.status}));const t={};i.forEach(s=>{t[s.nctId]=!0}),$(s=>({...s,...t})),h([])}},className:"w-full inline-flex items-center justify-center rounded-full bg-[#1033e5] px-4 py-3 text-white text-sm font-medium hover:bg-blue-700",children:"Confirm & Add Trials"})})]})]})]})]}),e.jsx("footer",{className:"w-full border-t mt-16",children:e.jsxs("div",{className:"w-full max-w-[1200px] mx-auto px-4 py-6 text-sm text-gray-600 flex items-center justify-between",children:[e.jsx("span",{children:"Copyright © 2025 TrialCliniq."}),e.jsx("span",{children:"Terms · Privacy"})]})})]})}export{me as default};
