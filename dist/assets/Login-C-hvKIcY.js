import{e as S,u as L,f as I,r as c,R as _,g as f,j as e,L as E,s as R,h as P}from"./index-D6Ufhlin.js";import{H as k}from"./HomeHeader-Up37SKaB.js";import"./HeaderActions-BQWpB5F1.js";import"./search-CHzgFv4o.js";import"./shield-DQUYGTD0.js";function q(){var b;const l=S(),r=L(),{isAuthenticated:d,signIn:y,user:o}=I(),[m,j]=c.useState(""),[p,u]=c.useState(null),[g,x]=c.useState(!1),h=(b=r.state)==null?void 0:b.authMessage;_.useEffect(()=>{var a,s;if(d){const i=(s=(a=r.state)==null?void 0:a.from)==null?void 0:s.pathname,t=(o==null?void 0:o.role)==="provider"?"/providers/dashboard":"/patients/dashboard",n=f(i||t);l(n,{replace:!0})}},[d,l,r.state,o]);const N=async a=>{var s,i;a.preventDefault(),u(null),x(!0);try{const t=((i=(s=r.state)==null?void 0:s.from)==null?void 0:i.pathname)||"/providers/dashboard",n=m.trim();R(t),localStorage.setItem("pending_signup_v1",JSON.stringify({email:n,role:"provider"})),localStorage.setItem("pending_role_v1","provider");const v=await P({email:n,password:""});if(v){y({...v,role:"provider"});const w=f(t);localStorage.removeItem("pending_signup_v1"),localStorage.removeItem("pending_role_v1"),l(w,{replace:!0})}}catch(t){u(t instanceof Error?t.message:"Invalid email or password. Please try again.")}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen bg-white text-gray-900",children:[e.jsx(k,{}),e.jsxs("main",{className:"max-w-md mx-auto px-4 py-10",children:[e.jsx("h1",{className:"text-3xl font-semibold mb-6",children:"Provider Login"}),h&&e.jsx("div",{className:"mb-4 rounded border border-amber-300 bg-amber-50 text-amber-800 px-3 py-2 text-sm",children:h}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Work email",type:"email",value:m,onChange:a=>j(a.target.value)}),p&&e.jsx("div",{className:"text-sm text-red-600",children:p}),e.jsx("button",{className:"w-full px-4 py-2 rounded bg-gray-900 text-white hover:bg-black disabled:opacity-50 disabled:cursor-not-allowed",type:"submit",disabled:g,children:g?"Redirecting...":"Continue with Microsoft"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:["New to TrialCliniq? ",e.jsx(E,{to:"/providers/create",className:"text-blue-600 hover:underline",children:"Create an account"})]})]})]})}export{q as default};
