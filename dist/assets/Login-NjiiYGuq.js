import{e as j,u as N,f as w,r as l,R as S,j as e,L as E,s as L}from"./index-BDmcj3uD.js";import{H as I}from"./HomeHeader-BQ5ppljt.js";import"./HeaderActions-BxMjWePd.js";import"./search-BbRWnryx.js";import"./shield-DfeMmaU7.js";function A(){var g;const i=j(),r=N(),{isAuthenticated:c,signIn:b,user:o}=w(),[m,f]=l.useState(""),[d,u]=l.useState(null),[p,x]=l.useState(!1),h=(g=r.state)==null?void 0:g.authMessage;S.useEffect(()=>{var a,s;if(c){const n=(s=(a=r.state)==null?void 0:a.from)==null?void 0:s.pathname,t=(o==null?void 0:o.role)==="provider"?"/providers/dashboard":"/patients/dashboard";i(n||t,{replace:!0})}},[c,i,r.state,o]);const v=async a=>{var s,n;a.preventDefault(),u(null),x(!0);try{localStorage.removeItem("pending_signup_v1"),localStorage.setItem("pending_role_v1","patient");const t=await L({email:m.trim(),password:""});if(t){b({...t,role:"patient"});const y=((n=(s=r.state)==null?void 0:s.from)==null?void 0:n.pathname)||"/patients/dashboard";i(y,{replace:!0})}}catch(t){u(t instanceof Error?t.message:"Invalid email or password. Please try again.")}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen bg-white text-gray-900",children:[e.jsx(I,{}),e.jsxs("main",{className:"max-w-md mx-auto px-4 py-10",children:[e.jsx("h1",{className:"text-3xl font-semibold mb-6",children:"Participant Login"}),h&&e.jsx("div",{className:"mb-4 rounded border border-amber-300 bg-amber-50 text-amber-800 px-3 py-2 text-sm",children:h}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx("input",{className:"w-full border rounded px-3 py-2",placeholder:"Email",type:"email",value:m,onChange:a=>f(a.target.value)}),d&&e.jsx("div",{className:"text-sm text-red-600",children:d}),e.jsx("button",{className:"w-full px-4 py-2 rounded bg-gray-900 text-white hover:bg-black disabled:opacity-50 disabled:cursor-not-allowed",type:"submit",disabled:p,children:p?"Redirecting...":"Continue with Microsoft"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-4",children:["No account? ",e.jsx(E,{to:"/patients/volunteer",className:"text-blue-600 hover:underline",children:"Sign up"})]})]})]})}export{A as default};
