import{u as K,R as s,j as e,h as Z}from"./index-DLD9h1BK.js";import{S as z}from"./SiteHeader-BviLql_-.js";import"./HeaderActions-VMSc5EzH.js";function te(){const{search:I}=K();s.useMemo(()=>new URLSearchParams(I).get("nctId")||"",[I]);const[D,j]=s.useState(""),[v,A]=s.useState(!1),[p,q]=s.useState(""),[g,H]=s.useState(""),[d,L]=s.useState(""),[m,$]=s.useState(""),[f,E]=s.useState(""),[y,F]=s.useState(""),[b,R]=s.useState(""),[l,N]=s.useState([]),[u,w]=s.useState(""),[x,B]=s.useState({}),[r,V]=s.useState(!1),[i,S]=s.useState([]),[h,k]=s.useState(""),[P,W]=s.useState(!1),[Y,G]=s.useState(!1),O=s.useMemo(()=>{const t=new Date().getFullYear();return Array.from({length:80},(a,o)=>String(t-o))},[]),C=P&&Y&&p&&g&&f&&y&&b&&d&&m;async function T(t){if(t.preventDefault(),!C)return;let a=null;try{const n=localStorage.getItem("pending_signup_v1");a=n?JSON.parse(n):null}catch{}if(!(a!=null&&a.email)){j("Please start sign up from the patient registration form.");return}j(""),A(!0);const o=new Date(p),c=new Date;let _=c.getFullYear()-o.getFullYear();const M=c.getMonth()-o.getMonth();(M<0||M===0&&c.getDate()<o.getDate())&&_--;const J={patientId:"",email:(a==null?void 0:a.email)||"",emailVerified:!1,age:String(_),weight:g,phone:(a==null?void 0:a.phone)||"",gender:f,race:y,language:b,bloodGroup:"",genotype:"",hearingImpaired:!1,visionImpaired:!1,primaryCondition:!r&&l.length>0?l[0]:"",diagnosed:!r&&l.length>0&&x[l[0]]||"",allergies:[],medications:i.map(n=>({name:n})),additionalInfo:r?`Location: ${d}, Travel Distance: ${m}, Healthy Volunteer`:`Location: ${d}, Travel Distance: ${m}, Diagnosed Conditions: ${l.map(n=>`${n} (${x[n]||"unknown"})`).join(", ")}`,ecog:"",diseaseStage:"",biomarkers:"",priorTherapies:[],comorbidityCardiac:!1,comorbidityRenal:!1,comorbidityHepatic:!1,comorbidityAutoimmune:!1,infectionHIV:!1,infectionHBV:!1,infectionHCV:!1};try{localStorage.setItem("tc_health_profile_v1",JSON.stringify(J))}catch{}const U={dob:p,weight:g,gender:f,race:y,language:b,zip:d,distance:m,conditions:l,diagnosisYears:x,healthy:r,medications:i};try{localStorage.setItem("tc_eligibility_profile",JSON.stringify(U))}catch{}try{localStorage.setItem("pending_role_v1","patient"),await Z({email:a.email,password:"",firstName:a.firstName||"",lastName:a.lastName||""})}catch(n){j(n instanceof Error?n.message:"Sign up failed. Please try again."),A(!1)}}return e.jsxs("div",{className:"min-h-screen bg-white text-gray-900",children:[e.jsx(z,{}),e.jsxs("main",{className:"max-w-3xl mx-auto px-4 py-10",children:[e.jsx("h1",{className:"text-center text-3xl font-semibold",children:"Complete Your Signup Information"}),e.jsx("p",{className:"mt-2 text-center text-gray-600",children:"Answer a few quick questions to finish creating your account."}),e.jsx("div",{className:"mt-4 flex items-center justify-center gap-2 text-xs text-gray-600",children:e.jsxs("button",{className:"inline-flex items-center gap-1 rounded-full border px-3 py-1 hover:bg-gray-50",type:"button",children:["Why are we asking this? ",e.jsx("span",{className:"text-gray-400",children:"ⓘ"})]})}),e.jsxs("form",{onSubmit:T,className:"mt-6 space-y-5",children:[D&&e.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:D}),e.jsx("div",{className:"rounded-2xl border bg-white p-5 shadow-sm space-y-5",children:e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Date of Birth",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:p,onChange:t=>q(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Weight (lbs)",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{inputMode:"decimal",value:g,onChange:t=>H(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",placeholder:"e.g. 165",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Biological Gender",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:f,onChange:t=>E(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{children:"Female"}),e.jsx("option",{children:"Male"}),e.jsx("option",{children:"Non-binary"}),e.jsx("option",{children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Race",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y,onChange:t=>F(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select your race"}),["Asian","Black / African American","White","Native American","Pacific Islander","Other","Prefer not to say"].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Primary Language Spoken",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:b,onChange:t=>R(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Select language"}),["English","Spanish","French","German","Italian","Portuguese"].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Your Location (City, State or ZIP)",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{value:d,onChange:t=>L(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",placeholder:"e.g. 10001 or Buffalo, NY",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Travel Distance",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:m,onChange:t=>$(t.target.value),className:"mt-2 w-full rounded-full border px-4 py-2",required:!0,children:[e.jsx("option",{value:"",children:"How far can you travel"}),["25mi","50mi","100mi","200mi","300mi","500mi","1000mi"].map(t=>e.jsx("option",{value:t,children:t},t))]})]})]})}),e.jsxs("div",{className:"rounded-2xl border bg-white p-5 shadow-sm space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Primary Condition(s)"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"You can add as many as apply. If you’re unsure of the exact name, type what you know, we’ll help match it."}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{value:u,onChange:t=>w(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),u.trim()&&(N([...l,u.trim()]),w("")))},className:"flex-1 w-full rounded-full border px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Search medical condition or keyword"}),e.jsx("button",{type:"button",onClick:()=>{u.trim()&&(N([...l,u.trim()]),w(""))},className:"rounded-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 whitespace-nowrap",children:"Add"})]}),l.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:l.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-full bg-blue-50 px-3 py-2",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{type:"button",onClick:()=>N(l.filter((o,c)=>c!==a)),className:"text-gray-500 hover:text-red-600 font-bold",children:"✕"})]},a))})]}),l.length===0&&e.jsxs("label",{className:"mt-3 flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:t=>V(t.target.checked),className:"rounded"})," I am a healthy volunteer"]})]}),l.length>0&&!r&&e.jsxs(e.Fragment,{children:[l.map(t=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium",children:["When were you diagnosed with ",t,"?",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:x[t]||"",onChange:a=>B({...x,[t]:a.target.value}),className:"mt-2 w-full rounded-full border px-4 py-2 text-gray-700",required:!0,children:[e.jsx("option",{value:"",children:"Select year"}),O.map(a=>e.jsx("option",{value:a,children:a},a))]})]},t)),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Your Current Medications"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Include prescription, over-the-counter, or supplements you take regularly. Add as many as apply."}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{value:h,onChange:t=>k(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),h.trim()&&(S([...i,h.trim()]),k("")))},className:"flex-1 w-full rounded-full border px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Start typing a medication name (e.g. Metformin, Lis...)"}),e.jsx("button",{type:"button",onClick:()=>{h.trim()&&(S([...i,h.trim()]),k(""))},className:"rounded-full bg-blue-600 text-white px-4 py-2 text-sm font-medium hover:bg-blue-700 whitespace-nowrap",children:"Add"})]}),i.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:i.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-full bg-blue-50 px-3 py-2",children:[e.jsx("span",{className:"text-sm text-gray-900",children:t}),e.jsx("button",{type:"button",onClick:()=>S(i.filter((o,c)=>c!==a)),className:"text-gray-500 hover:text-red-600 font-bold",children:"✕"})]},a))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:P,onChange:t=>W(t.target.checked)})," I have read and agree to the Consent to Enroll and Privacy Policy."]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:Y,onChange:t=>G(t.target.checked)})," I consent to share my (or the volunteer’s) health data for clinical trial matching under HIPAA-compliant protocols."]}),e.jsx("div",{className:"text-xs text-gray-600",children:"You may revoke consent at any time in Settings"}),e.jsx("button",{disabled:!C||v,className:`w-full rounded-full px-6 py-3 text-white font-medium ${C&&!v?"bg-[#1033e5] hover:bg-blue-700":"bg-blue-400 cursor-not-allowed"}`,children:v?"Connecting to Microsoft...":"Continue"}),e.jsx("div",{className:"text-center text-xs text-gray-600",children:"Your data stays private and protected with HIPAA-compliant security."})]})]})]})]})}export{te as default};
